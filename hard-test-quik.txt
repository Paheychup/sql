
Перейти к концу метаданных
Создатель Чупахин Павел Игоревич, отредактировано 24.07.2021Переход к началу метаданных
Основные моменты , которые нужно учитывать при подготовке к нагрузочному тестированию сервера Quik.

За день до проведения нагрузочного тестирования:

Поставить задачу в SUP на изменение работы с услугой MT5 на выходные дни.
SUP-96162 - Изменить работу с услугой МТ5 в Личном кабинете на выходные ЗАКРЫТ
Оповестить пользователей Quik сообщением в Qmonitor's о недоступности серверов на выходных через отдел поддержки. Отправить сообщение несколько раз в день.
Оповестить руководителей УКО о недоступности серверов Quik на выходных в связи с проведением нагрузочного тестирования. + Уведомить трейдеров, т.к. квик на следующий день автоматически не подключиться.
В Qadmin разблокировать терминалы, которые будут использоваться для нагрузочного тестирования и подключить возможность входа по логину и паролю. UID 173589, 173591, 173592 для ФР, ВР, СР соответственно.
Проверить права по рынкам в том числе на активные операции. Важно: снять в БРЛ ограничение на количество транзакций в секунду, если установлено.
Предупредить отдел поддержки, чтобы данные терминалы не блокировали до окончания проведения нагрузочного тестирования.
Предупредить отдел безопасности, что с этих терминалов будет осуществляться подключения во время нагрузочного тестирования.
Выбрать 3 сервера доступа, на которых установить Quik для каждого из рынков. 
Например, на 10.55.140.57 установить Quik ФР, на 10.55.140.58 - Quik ВР, на 10.55.140.59 - Quik СР. Какую версию терминала Quik устанавливать написано в инструкции от ARQA Technologies.
Поставить задачу в UIT, чтобы открыли доступ с серверов доступа из пункта 7 на сервер Quik по порту, который будет участвовать в нагрузочном тестировании. Выбрать отличный от 15100, например, 15188.
Порт нужно будет изменить для того, чтобы никакие сервера доступа и сервисы не могли подключиться к серверу в день тестирования. 
Терминалы Quik нужно подключать в нулевую зону минуя сервера доступа. Подробности, как изменить порт - ниже.
Подготовить файл с лимитами для загрузки на сервер в день нагрузочного тестирования. Более подробно написано в инструкции от ARQA Technologies, которую присылают заранее.
Внимание!!! Формирование файла с лимитами требует значительных затрат времени. Важно также установить глобальные лимиты.
Отправить на биржу информацию о разделе срочного рынка (например, 41), по которому будут выставляться заявки, а также торговые счета (например, 4110WCY), с которых будет производиться торговля во время нагрузочного тестирования.
Перенести запуск в режиме выходного дня, тестируемого сервера на следующую неделю.
Перенести запуск модуля SMS, репликатора, сервисов webquik и Syncuser на понедельник.

В день проведения нагрузочного тестирования: 

В 00:10 отключить все шлюзы MT5 на тестовом и тестого-боевом контурах. Проверить утром в 8:00, что шлюзы отключены.
Отключить ВСЕ QUU к мастер базе Quik, если она участвует в тестировании, отключить репликатор и смс модуль от сервера, на котором будет проводится тестирование.
ВАЖНО!!! После остановки сервера сделать свежий бэкап базы данных и ВАЖНО!!! переименовать, чтобы случайно не затерся.
ВАЖНО!!! Сделать полные бэкапы папок сервера, шлюзов ФР AstsTw\AstsRiskTW , ВР AstsCurr\AstsCurrRisk , СР FortsGate\SpectraCGate, кроссрейт.
ВАЖНО!!! Изменить порт сервера в quik.ini в секции [usend_module], чтобы исключить возможность подключаться другим сервисам и сд.
Указать тот, на который просили открыть доступ по задачи UIT, из примера - port=15188.
Необходимо подключение модуля Crossrate,  поэтому нужно изменить в настройках модуля порт подключения к серверу на 15188 из примера в файле quikapi.ini
Следовать инструкции (регламенту) ARQA Technologies.
После выполнения всех инструкций нужно стартовать сервер Quik с подготовленным файлом с лимитами.
Торговые шлюзы нужно запускать, когда биржа подготовит торговые платформы. До этого времени ни информация по торговым счетам, ни информация по заявкам и т.д. не будет видна в Quik.
Следовать инструкции (регламенту) ARQA Technologies.
После окончания нагрузочного тестирования нужно откатить назад папки с бэкапами шлюзов, сервера, а также развернуть бд из пункта 3.

В понедельник утреннему дежурному включить шлюзы MT5, проверить, что запущена служба QUU.

Проверить измененные порты, проверить лимиты.